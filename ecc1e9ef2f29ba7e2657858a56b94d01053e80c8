- completly rewrited in PLD style.

Based on spec from MDK.
